From 3ffa79c95cd02a781d900aa76b61142649339b43 Mon Sep 17 00:00:00 2001
From: Dominggoes Isakh <drjisakh@gmail.com>
Date: Fri, 12 May 2023 23:01:39 +0200
Subject: [PATCH 17/47] Revert "Fix an issue that the
 syncTimestampToDisplayLocked incorrect"

This reverts commit 1c0042b52fcaf018b9b5988c01c69009be0baf82.

Signed-off-by: Dominggoes Isakh <drjisakh@gmail.com>
---
 .../camera/libcameraservice/device3/Camera3OutputStream.cpp    | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/services/camera/libcameraservice/device3/Camera3OutputStream.cpp b/services/camera/libcameraservice/device3/Camera3OutputStream.cpp
index 478c9fdd83..141a8ae06b 100644
--- a/services/camera/libcameraservice/device3/Camera3OutputStream.cpp
+++ b/services/camera/libcameraservice/device3/Camera3OutputStream.cpp
@@ -1506,8 +1506,7 @@ nsecs_t Camera3OutputStream::syncTimestampToDisplayLocked(nsecs_t t) {
                 vsyncTime.deadlineTimestamp >= currentTime &&
                 ((!cameraDisplayInSync && vsyncTime.expectedPresentationTime > minPresentT) ||
                  (cameraDisplayInSync && vsyncTime.expectedPresentationTime >
-                mLastPresentTime + minInterval +
-                    static_cast<nsecs_t>(biasForShortDelay * kTimelineThresholdNs)))) {
+                mLastPresentTime + minInterval + biasForShortDelay * kTimelineThresholdNs))) {
             expectedPresentT = vsyncTime.expectedPresentationTime;
             minDiff = std::abs(vsyncTime.expectedPresentationTime - idealPresentT);
         }
-- 
2.40.1

